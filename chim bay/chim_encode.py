import base64
exec(base64.b64decode('aW1wb3J0IHB5Z2FtZSwgc3lzLCByYW5kb20KZnJvbSB0a2ludGVyIGltcG9ydCAgbWVzc2FnZWJveAoKIyBuaOG6r2Mgbmjhu58gxJHhuqd1Cm1lc3NhZ2Vib3guc2hvd2luZm8odGl0bGU9Im5o4bqvYyBuaOG7nyBuaOG6uSIsCgkKCQkJbWVzc2FnZT0iY2jGoWkgxJHhu6tuZyBjw7MgbcOgIHF14bqhbyBuaMOhISEhISIpCiMgdOG6oW8gaMOgbSBnYW1lCmRlZiBkcmF3X2Zsb29yKCk6CglzY3JlZW4uYmxpdChmbG9vciwoZmxvb3JfeF9wb3MsNjAwKSkKCXNjcmVlbi5ibGl0KGZsb29yLChmbG9vcl94X3BvcysgNDMyLDYwMCkpCmRlZiBjcmVhdGVfcGlwZSgpOgoJcmFuZG9tX3BpcGVfcG9zID0gcmFuZG9tLmNob2ljZShwaXBlX2hlaWdodCkKCWJvdHRvbV9waXBlID0gcGlwZV9zdXJmYWNlLmdldF9yZWN0KG1pZHRvcD0oNjAwLHJhbmRvbV9waXBlX3BvcykpCQoJdG9wX3BpcGUgPSBwaXBlX3N1cmZhY2UuZ2V0X3JlY3QobWlkdG9wPSg2MDAscmFuZG9tX3BpcGVfcG9zLTc1MCkpCQoJcmV0dXJuIGJvdHRvbV9waXBlICwgdG9wX3BpcGUKZGVmIG1vdmVfcGlwZShwaXBlcyk6Cglmb3IgcGlwZSBpbiBwaXBlcyA6CQoJCXBpcGUuY2VudGVyeCAtPSA1CglyZXR1cm4gcGlwZXMKZGVmCWRyYXdfcGlwZShwaXBlcyk6Cglmb3IgcGlwZSBpbiBwaXBlczoKCQlpZiBwaXBlLmJvdHRvbSA+PSA2MDA6CgkJCXNjcmVlbi5ibGl0KHBpcGVfc3VyZmFjZSxwaXBlKQoJCWVsc2U6CgkJCWZsaXBfcGlwZSA9IHB5Z2FtZS50cmFuc2Zvcm0uZmxpcChwaXBlX3N1cmZhY2UsRmFsc2UsVHJ1ZSkKCQkJc2NyZWVuLmJsaXQoZmxpcF9waXBlLHBpcGUpCmRlZiBjaGVja19jbGxpc3Rpb24ocGlwZXMpOgoJZm9yIHBpcGUgaW4gcGlwZXM6CgkJaWYgYmlyZF9yZWN0LmNvbGxpZGVyZWN0KHBpcGUpOgoJCQl0Z192YV9jaGFtLnBsYXkoKQoJCQlyZXR1cm4gRmFsc2UKCWlmIGJpcmRfcmVjdC50b3AgPD0gLTc1IG9yIGJpcmRfcmVjdC5ib3R0b20gPj0gNjUwOgkKCQlyZXR1cm4gRmFsc2UKCXJldHVybiBUcnVlCQpkZWYgcm90YXRlX2JpcmQoYmlyZDEpOgoJbmV3X2JpcmQgPSBweWdhbWUudHJhbnNmb3JtLnJvdG96b29tKGJpcmQxLC1iaXJkX21vdmVtZW50KjMsMSkKCXJldHVybiBuZXdfYmlyZApkZWYgYmlyZF9hbmltYXRpb24oKToKCW5ld19iaXJkID0gYmlyZF9saXN0W2JpcmRfaW5kZXhdCgluZXdfYmlyZF9yZWN0ID0gbmV3X2JpcmQuZ2V0X3JlY3QoY2VudGVyID0gKDEwMCxiaXJkX3JlY3QuY2VudGVyeSkpCglyZXR1cm4gbmV3X2JpcmQsIG5ld19iaXJkX3JlY3QKCgpkZWYgc2NvcmVfZGlzcGxheShnYW1lX3N0YXRlKToKCWlmIGdhbWVfc3RhdGUgPT0gJ21haW4gZ2FtZSc6CgkJc2NvcmVfc3VyZmFjZSA9IGdhbWVfZm9udF8yLnJlbmRlcihzdHIoaW50KHNjb3JlKSksVHJ1ZSwoMCw1MSwxMDIpKQkKCQlzY29yZV9yZWN0ID0gc2NvcmVfc3VyZmFjZS5nZXRfcmVjdChjZW50ZXIgPSAoMjE2LDEwMCkpCgkJc2NyZWVuLmJsaXQoc2NvcmVfc3VyZmFjZSxzY29yZV9yZWN0KQoJaWYgZ2FtZV9zdGF0ZSA9PSAnZ2FtZV9vdmVyJzoKCQlzY29yZV9zdXJmYWNlID0gZ2FtZV9mb250XzIucmVuZGVyKHN0cihmJyB7aW50KHNjb3JlKX0nKSxUcnVlLCgwLDUxLDEwMikpCQoJCXNjb3JlX3JlY3QgPSBzY29yZV9zdXJmYWNlLmdldF9yZWN0KGNlbnRlciA9ICgyMTYsMTAwKSkKCQlzY3JlZW4uYmxpdChzY29yZV9zdXJmYWNlLHNjb3JlX3JlY3QpCQoKCgojIGPDoWMgVEggeOG6o3kgcmEga2hpIHRodWEgbsOgCgkJIyBu4bq/dSB2w6BvIGTEkWnhurttIG3DoCBu4bqxbSB0cmcgbsOgeSB0aMOsIGLhuq10IHJpY2sKCQlyaWNrX251bSA9WzEzLDM0LDEsMjYsNDcsMjAsMTAwLDIwMCwzLDIwLDExLDM1LDQwXQoJCWlmIHNjb3JlID09IHJpY2tfbnVtOgoJCQlyaWNrLnBsYXkoKQoJCWlmIHNjb3JlID49IDEgYW5kIHNjb3JlIDwgMTAgLy9UcnVlOgoJCQloaWdoX3Njb3JlX3N1cmZhY2UgPSBnYW1lX2ZvbnQucmVuZGVyKHN0cihmJ2fDoCB2w6NpJyksVHJ1ZSwoMCw1MSwxMDIpKQkKCQkJaGlnaF9zY29yZV9yZWN0ID0gaGlnaF9zY29yZV9zdXJmYWNlLmdldF9yZWN0KGNlbnRlciA9ICgyMTYsNTAwKSkKCQkJc2NyZWVuLmJsaXQoaGlnaF9zY29yZV9zdXJmYWNlLGhpZ2hfc2NvcmVfcmVjdCkKCQlpZiBzY29yZSA+PSAxMSBhbmQgc2NvcmUgPCAxNSAvL1RydWU6CgkJCWhpZ2hfc2NvcmVfc3VyZmFjZSA9IGdhbWVfZm9udC5yZW5kZXIoc3RyKGYnd3RmLHbhuqtuIGfDoCcpLFRydWUsKDAsNTEsMTAyKSkJCgkJCWhpZ2hfc2NvcmVfcmVjdCA9IGhpZ2hfc2NvcmVfc3VyZmFjZS5nZXRfcmVjdChjZW50ZXIgPSAoMjE2LDUwMCkpCgkJCXNjcmVlbi5ibGl0KGhpZ2hfc2NvcmVfc3VyZmFjZSxoaWdoX3Njb3JlX3JlY3QpCQoJCWlmIHNjb3JlID49IDE2IGFuZCBzY29yZSA8IDI5IC8vVHJ1ZToKCQkJaGlnaF9zY29yZV9zdXJmYWNlID0gZ2FtZV9mb250LnJlbmRlcihzdHIoZidwbGF5IG1vcmU/PycpLFRydWUsKDAsNTEsMTAyKSkJCgkJCWhpZ2hfc2NvcmVfcmVjdCA9IGhpZ2hfc2NvcmVfc3VyZmFjZS5nZXRfcmVjdChjZW50ZXIgPSAoMjE2LDUwMCkpCgkJCXNjcmVlbi5ibGl0KGhpZ2hfc2NvcmVfc3VyZmFjZSxoaWdoX3Njb3JlX3JlY3QpCQkJCgkJaWYgc2NvcmUgPj0gMzAgIGFuZCBzY29yZSA8IDY5IC8vVHJ1ZToKCQkJaGlnaF9zY29yZV9zdXJmYWNlID0gZ2FtZV9mb250LnJlbmRlcihzdHIoZidnb29kIGpvYicpLFRydWUsKDAsNTEsMTAyKSkJCgkJCWhpZ2hfc2NvcmVfcmVjdCA9IGhpZ2hfc2NvcmVfc3VyZmFjZS5nZXRfcmVjdChjZW50ZXIgPSAoMjE2LDUwMCkpCgkJCXNjcmVlbi5ibGl0KGhpZ2hfc2NvcmVfc3VyZmFjZSxoaWdoX3Njb3JlX3JlY3QpCQkJCgoJCWlmIHNjb3JlID49IDcwIC8vVHJ1ZToKCQkJaGlnaF9zY29yZV9zdXJmYWNlID0gZ2FtZV9mb250LnJlbmRlcihzdHIoZidQcm8gcGxheWVyISEnKSxUcnVlLCgwLDUxLDEwMikpCQoJCQloaWdoX3Njb3JlX3JlY3QgPSBoaWdoX3Njb3JlX3N1cmZhY2UuZ2V0X3JlY3QoY2VudGVyID0gKDIxNiw1MDApKQoJCQlzY3JlZW4uYmxpdChoaWdoX3Njb3JlX3N1cmZhY2UsaGlnaF9zY29yZV9yZWN0KQoJCWlmIHNjb3JlID4gMTAwMCAvLyBUcnVlOgoJCQliZzIgPSBweWdhbWUuaW1hZ2UubG9hZCgnYXNzZXRzL25lbjQucG5nJykuY29udmVydCgpCgkJCWJnMiA9IHB5Z2FtZS50cmFuc2Zvcm0uc2NhbGUyeChiZzIpCQoJCQlzY3JlZW4uYmxpdChiZzIsKDAsMCkpCgkJcmV0dXJuCQoJCQkKCQojIHThuqFvIGtodW5nIGNobyBnYW1lCnB5Z2FtZS5taXhlci5wcmVfaW5pdChmcmVxdWVuY3k9NDQxMDAsIHNpemU9LTE2LCBjaGFubmVscz0yLCBidWZmZXI9NTEyKQpweWdhbWUuaW5pdCgpCnNjcmVlbiA9IHB5Z2FtZS5kaXNwbGF5LnNldF9tb2RlKCg0MzIsNzY4KSkKY2xvY2sgPSBweWdhbWUudGltZS5DbG9jaygpCnB5Z2FtZS5kaXNwbGF5LnNldF9jYXB0aW9uKCJDSElNQkFZICEhISBNQURFIEJZIFZEVUMiKQpnYW1lX2ZvbnQgPSBweWdhbWUuZm9udC5Gb250KCdnYW1lIGZvbnQudHRmJyw0MCkKZ2FtZV9mb250XzIgPSBweWdhbWUuZm9udC5Gb250KCcwNEJfMTkuVFRGJywgNjApCiMgdOG6oW8gYmnhur9uIGdhbWUKZ3Jhdml0eSA9IDAuMjUKYmlyZF9tb3ZlbWVudCA9IDAKZ2FtZV9hY3RpdmUgPSBGYWxzZQpzY29yZSA9IDAKaGlnaF9zY29yZSA9IDAKI2jDrG5oIG7hu4FuIG7DoAoKYmcgPSBweWdhbWUuaW1hZ2UubG9hZCgnYXNzZXRzL25lbi5wbmcnKS5jb252ZXJ0KCkKYmcgPSBweWdhbWUudHJhbnNmb3JtLnNjYWxlMngoYmcpCiMgxJHhuqV0IG7DoApmbG9vciA9IHB5Z2FtZS5pbWFnZS5sb2FkKCdhc3NldHMvZGF0LnBuZycpLmNvbnZlcnQoKQpmbG9vciA9IHB5Z2FtZS50cmFuc2Zvcm0uc2NhbGUyeChmbG9vcikKZmxvb3JfeF9wb3MgPSAwCiMgY2hpbSBuw6AKIyBjaGltIGLDrG5oIHRoxrDhu51uZwpiaXJkX2J0aGcgPSBweWdhbWUuaW1hZ2UubG9hZCgnYXNzZXRzL2NoaW1fYnRoZy5wbmcnKS5jb252ZXJ0X2FscGhhKCkKYmlyZF9idGhnID0gcHlnYW1lLnRyYW5zZm9ybS5zY2FsZTJ4KGJpcmRfYnRoZykKIyBjaGltIGJheQpiaXJkX2xlbiA9IHB5Z2FtZS5pbWFnZS5sb2FkKCdhc3NldHMvY2hpbSBiYXkucG5nJykuY29udmVydF9hbHBoYSgpCmJpcmRfbGVuID0gcHlnYW1lLnRyYW5zZm9ybS5zY2FsZTJ4KGJpcmRfbGVuKQojIGNoaW0geHXhu5FuZwpiaXJkX3h1b25nID0gcHlnYW1lLmltYWdlLmxvYWQoJ2Fzc2V0cy9jaGltIGhhLnBuZycpLmNvbnZlcnRfYWxwaGEoKQpiaXJkX3h1b25nID0gcHlnYW1lLnRyYW5zZm9ybS5zY2FsZTJ4KGJpcmRfeHVvbmcpCiMgZGFuaCBzw6FjaCBjaGltCmJpcmRfbGlzdCA9IFtiaXJkX3h1b25nLGJpcmRfYnRoZyxiaXJkX2xlbl0gIyAwIDEgMgpiaXJkX2luZGV4ID0gMApiaXJkID0gYmlyZF9saXN0W2JpcmRfaW5kZXhdCiMgSMOsbmggY2jFqXcgbmjhuq10IHF1YW5oIGNvbiBjaGltCmJpcmRfcmVjdCA9IGJpcmQuZ2V0X3JlY3QoY2VudGVyID0gKDEwMCwzODQpKQojIFThuqBPIFRJTUUgQ0hPIENPTiBDSElNCmJpcmRfZmxhcCA9cHlnYW1lLlVTRVJFVkVOVCArIDEKcHlnYW1lLnRpbWUuc2V0X3RpbWVyKGJpcmRfZmxhcCwyMDApCiMgIOG7kW5nIG7DoApwaXBlX3N1cmZhY2UgPSBweWdhbWUuaW1hZ2UubG9hZCgnYXNzZXRzL29uZy5wbmcnKS5jb252ZXJ0KCkKcGlwZV9zdXJmYWNlID0gcHlnYW1lLnRyYW5zZm9ybS5zY2FsZTJ4KHBpcGVfc3VyZmFjZSkKcGlwZV9saXN0ID0gW10KIyB0YW8gdGltZSBs4bqleSDhu5FuZwpzcGF3bnBpcGUgPSBweWdhbWUuVVNFUkVWRU5UCnB5Z2FtZS50aW1lLnNldF90aW1lcihzcGF3bnBpcGUsMTAwMCkKcGlwZV9oZWlnaHQgPSBbMzAwLDQwMCw1MDAsMzUwLDQ1MCw1MjAsNDEwLDMxMCwzMjAsNDMwXQojIG3DoG4gaMOsbmggdGh1YQpnYW1lX292ZXJfc3VyZmFjZSA9IHB5Z2FtZS5pbWFnZS5sb2FkKCdhc3NldHMvdGh1YS5wbmcnKS5jb252ZXJ0KCkKZ2FtZV9vdmVyX3N1cmZhY2UgPSBweWdhbWUudHJhbnNmb3JtLnNjYWxlMngoZ2FtZV9vdmVyX3N1cmZhY2UpCmdhbWVfb3Zlcl9yZWN0ID0gZ2FtZV9vdmVyX3N1cmZhY2UuZ2V0X3JlY3QoY2VudGVyID0gKDIxNiwzODQpKQoKI2Now6huIMOibSB0aGFuaAp0Z192byA9IHB5Z2FtZS5taXhlci5Tb3VuZCgnc291bmQvc2Z4X3dpbmcud2F2JykKdGdfdmFfY2hhbSA9IHB5Z2FtZS5taXhlci5Tb3VuZCgnc291bmQvcHVuY2gud2VibScpCmJ5ZSAgPQlweWdhbWUubWl4ZXIuU291bmQoJ3NvdW5kL2JhaS53YXYnKQojdHJvbGwKcmljayA9IHB5Z2FtZS5taXhlci5Tb3VuZCgnc291bmQvcmljay5tcDMnKQojIGxvb3AgY2hvIGdhbWUKd2hpbGUgVHJ1ZToKCWZvciBldmVudCBpbiBweWdhbWUuZXZlbnQuZ2V0KCk6CgkJaWYgZXZlbnQudHlwZSA9PSBweWdhbWUuUVVJVDoKCQkJcHlnYW1lLnF1aXQoKQoJCQlzeXMuZXhpdCgpCgkJaWYJZXZlbnQudHlwZSA9PSBweWdhbWUuS0VZRE9XTjoKCQkJaWYgZXZlbnQua2V5ID09IHB5Z2FtZS5LX2cgOgoJCQkJYmlyZF9tb3ZlbWVudCA9IDAKCQkJCWJpcmRfbW92ZW1lbnQgPSAtOAoJCQkJdGdfdm8ucGxheSgpCgkJCWlmIGV2ZW50LmtleSA9PSBweWdhbWUuS19nICBhbmQgZ2FtZV9hY3RpdmUgPT0gRmFsc2U6CQoJCQkJZ2FtZV9hY3RpdmUgPSBUcnVlCgkJCQlwaXBlX2xpc3QuY2xlYXIoKQkKCQkJCWJpcmRfcmVjdC5jZW50ZXIgPSAoMTAwLDM4NCkKCQkJCWJpcmRfbW92ZW1lbnQgPSAwCQoJCQkJc2NvcmUgPSAwCgkJCWlmIGV2ZW50LmtleSA9PSBweWdhbWUuS19tOgoJCQkJc2NvcmUgKz0gMTAJCQoJCQkJYmlyZF9tb3ZlbWVudCA9IDAKCQkJCWJpcmRfbW92ZW1lbnQgPSAtOAoJCQlpZiBldmVudC5rZXkgPT0gcHlnYW1lLktfcToKCQkJCWJpcmRfbW92ZW1lbnQgPSAwCgkJCQliaXJkX21vdmVtZW50ID0gLTUwCgoJCQkJCgoJCQlpZiBldmVudC5rZXkgPT0gcHlnYW1lLktfcDoKCQkJCWJ5ZS5wbGF5KDMpCgkJCQlweWdhbWUucXVpdCgpCgkJCQlzeXMuZXhpdCgpCgkJCQkKCQkJCQoJCWlmIGV2ZW50LnR5cGUgPT0gc3Bhd25waXBlIDoKCQkJcGlwZV9saXN0LmV4dGVuZChjcmVhdGVfcGlwZSgpKQkKCQlpZiBldmVudC50eXBlID09IGJpcmRfZmxhcDoKCQkJaWYgYmlyZF9pbmRleCA8CTI6CgkJCQliaXJkX2luZGV4ICs9IDEJCgkJCWVsc2U6CgkJCQliaXJkX2luZGV4ID0gMAoJCQliaXJkLGJpcmRfcmVjdCA9IGJpcmRfYW5pbWF0aW9uKCkKCgkJCQkJCQoJc2NyZWVuLmJsaXQoYmcsKDAsMCkpCgkKCWlmIGdhbWVfYWN0aXZlOgoJCSMgY2hpbQoJCWJpcmRfbW92ZW1lbnQgKz0gZ3Jhdml0eQoJCXJvdGF0ZWRfYmlyZCA9IHJvdGF0ZV9iaXJkKGJpcmQpCgkJYmlyZF9yZWN0LmNlbnRlcnkgKz0gYmlyZF9tb3ZlbWVudCAKCQlzY3JlZW4uYmxpdChyb3RhdGVkX2JpcmQsIGJpcmRfcmVjdCkKCQlnYW1lX2FjdGl2ZSA9IGNoZWNrX2NsbGlzdGlvbihwaXBlX2xpc3QpCgoJCSMg4buRbmcKCQlwaXBlX2xpc3QgPSBtb3ZlX3BpcGUocGlwZV9saXN0KQoJCWRyYXdfcGlwZShwaXBlX2xpc3QpCgkJIyB0xINuZyDEkWnhurttIHRoZW8gdGcKCQlzY29yZSArPSAwLjAxCiMgaGnhu4NuIHRoaSDEkWnhurttIG7DoAoJCQoJCXNjb3JlX2Rpc3BsYXkoJ21haW4gZ2FtZScpCgllbHNlOgoJCXNjcmVlbi5ibGl0KGdhbWVfb3Zlcl9zdXJmYWNlLGdhbWVfb3Zlcl9yZWN0KQoJCXNjb3JlX2Rpc3BsYXkoJ2dhbWVfb3ZlcicpCgkJIyBoaeG7g24gdGjhu4sgxJFp4bq7bSBjYW8gbsOgCQoKCSMgZOG6pXQKCWZsb29yX3hfcG9zIC09MQoJZHJhd19mbG9vcigpCglpZiBmbG9vcl94X3BvcyA8PSAtNDMyOgoJCWZsb29yX3hfcG9zID0gMAkJCgkJc2NyZWVuLmJsaXQoZmxvb3IsKGZsb29yX3hfcG9zLDYwMCkpCQoKCglweWdhbWUuZGlzcGxheS51cGRhdGUoKQoJY2xvY2sudGljaygxMjApCg=='))